<!DOCTYPE html>
<html>
<head>
    <title>Precision Crop Management</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
<div class="container">
    <h2>ðŸŒ± Precision Crop Management System</h2>

    <form action="/predict" method="post">

        <label>City</label>
        <input type="text" name="city" required>

        <label>Farm Area (hectares)</label>
        <input type="number" name="area" step="any" required>

        <label>Nitrogen (N)</label>
        <input type="number" name="N" step="any" required>

        <label>Phosphorus (P)</label>
        <input type="number" name="P" step="any" required>

        <label>Potassium (K)</label>
        <input type="number" name="K" step="any" required>

        <label>pH</label>
        <input type="number" name="ph" step="any" required>

        <label>Rainfall (mm)</label>
        <input type="number" name="rainfall" step="any" required>

        <button type="submit">Predict</button>
    </form>

    {% if crop %}
    <div class="result crop">ðŸŒ¾ Crop: {{ crop }}</div>
    <div class="result fertilizer">ðŸŒ¿ Fertilizer: {{ fertilizer }} ({{ fert_amount }} kg)</div>
    <div class="result irrigation">ðŸ’§ Irrigation: {{ irrigation }}</div>
    <div class="result yield">ðŸ“Š Expected Yield: {{ yield_estimate }} tons</div>
    <div class="result">ðŸŒ¦ Temperature: {{ temperature }}Â°C | Humidity: {{ humidity }}%</div>

    <!-- Hidden values for Chart -->
    <div id="chart-data"
         data-n="{{ N }}"
         data-p="{{ P }}"
         data-k="{{ K }}">
    </div>

    <!-- Chart -->
    <canvas id="nutrientChart"></canvas>

    <script>
        const chartData = document.getElementById("chart-data");

        const N = Number(chartData.dataset.n);
        const P = Number(chartData.dataset.p);
        const K = Number(chartData.dataset.k);

        const ctx = document.getElementById("nutrientChart").getContext("2d");

        new Chart(ctx, {
            type: "bar",
            data: {
                labels: ["Nitrogen", "Phosphorus", "Potassium"],
                datasets: [{
                    label: "Soil Nutrient Levels",
                    data: [N, P, K],
                    backgroundColor: ["#66bb6a", "#ffa726", "#42a5f5"]
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    </script>
    {% endif %}
</div>
</body>
</html>
